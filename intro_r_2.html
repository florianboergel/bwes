
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introduction into R - Part 2 &#8212; Baltic Earth Winter School</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Statistical tests in R" href="statistical_tests.html" />
    <link rel="prev" title="Introduction into R - Part 1" href="intro_r_1.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo_baltic_earth.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Baltic Earth Winter School</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Intro
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="statistic_lecture_1.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="content.html">
   Content in Jupyter Book
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="intro_r_1.html">
     Introduction into R - Part 1
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Introduction into R - Part 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="statistical_tests.html">
     Statistical tests in R
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Wavelet_lecture.html">
     Introduction to wavelet analysis
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/intro_r_2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fintro_r_2.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/intro_r_2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#outline">
   Outline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-formats-for-storing-time-information">
   1. Data formats for storing time information
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-linear-models">
   2. Simple linear models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lists-vs-vectors">
   3. Lists vs Vectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#working-with-netcdf-data-plotting-a-simple-map">
   4. Working with NetCDF data (plotting a simple map)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-statistical-tests">
   5. Basic statistical tests
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="introduction-into-r-part-2">
<h1>Introduction into R - Part 2<a class="headerlink" href="#introduction-into-r-part-2" title="Permalink to this headline">¶</a></h1>
<p>This is part 2/2 of the introduction into R that is given for the Baltic Earth Winter School (BEWS). Feel free to share and distribute it.</p>
<div class="section" id="outline">
<h2>Outline<a class="headerlink" href="#outline" title="Permalink to this headline">¶</a></h2>
<p>Part 1 of the introduction teaches some basic functionality of R.</p>
<ul class="simple">
<li><p>Variables and their data types</p></li>
<li><p>Vectors and data.frames</p></li>
<li><p>Reading and writing data (textfiles)</p></li>
<li><p>Loading packages</p></li>
<li><p>Creating simple plots</p></li>
<li><p>Loops and if-clauses</p></li>
<li><p>Writing your own functions</p></li>
<li><p>Using “apply” and “aggregate”</p></li>
</ul>
<p>Part 2 of the introduction teaches some R features specific to the analysis of time series and spatial data.</p>
<ul class="simple">
<li><p>Data formats for storing time information</p></li>
<li><p>Simple linear models (regression)</p></li>
<li><p>Lists vs Vectors</p></li>
<li><p>Working with NetCDF data (plotting simple maps)</p></li>
<li><p>Basic statistical tests</p></li>
</ul>
</div>
<div class="section" id="data-formats-for-storing-time-information">
<h2>1. Data formats for storing time information<a class="headerlink" href="#data-formats-for-storing-time-information" title="Permalink to this headline">¶</a></h2>
<p>Let us load the monthly sea level data file again which we used in the last exercise. Please enter the correct path.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#setwd(&quot;/students_files/feldner&quot;)   # put in your surname here</span>
<span class="n">sealevel</span> <span class="o">=</span> <span class="nf">read.csv2</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&quot;warnemuende.txt&quot;</span><span class="p">,</span> <span class="n">skip</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">sealevel</span><span class="o">$</span><span class="n">decimalyear</span> <span class="o">=</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="n">sealevel</span><span class="o">$</span><span class="n">decimalyear</span><span class="p">)</span>
<span class="n">sealevel</span><span class="o">$</span><span class="n">sealevel</span><span class="p">[</span><span class="n">sealevel</span><span class="o">$</span><span class="n">sealevel</span><span class="o">==</span><span class="m">-99999</span><span class="p">]</span><span class="o">=</span><span class="kc">NA</span>
<span class="nf">head</span><span class="p">(</span><span class="n">sealevel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We have the strange time unit <code class="docutils literal notranslate"><span class="pre">decimalyear</span></code>. We want to convert it to a more suitable time format. The best one is the POSIXct format.</p>
<p>To convert it to the format, we first split the decimalyear into year and day_of_year:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sealevel</span><span class="o">$</span><span class="n">year</span> <span class="o">=</span> <span class="nf">floor</span><span class="p">(</span><span class="n">sealevel</span><span class="o">$</span><span class="n">decimalyear</span><span class="p">)</span>
<span class="n">sealevel</span><span class="o">$</span><span class="n">day_of_year</span> <span class="o">=</span> <span class="p">(</span><span class="n">sealevel</span><span class="o">$</span><span class="n">decimalyear</span> <span class="o">-</span> <span class="n">sealevel</span><span class="o">$</span><span class="n">year</span><span class="p">)</span> <span class="o">*</span> <span class="m">365</span>  <span class="c1"># only approximately</span>
<span class="nf">head</span><span class="p">(</span><span class="n">sealevel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now let us first generate a date that is the first day of the year. Later we will add the days.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sealevel</span><span class="o">$</span><span class="n">date</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="n">sealevel</span><span class="o">$</span><span class="n">year</span><span class="p">,</span><span class="s">&quot;-01-01&quot;</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">sealevel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We convert to POSIXct now. Then we have to add the days as seconds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sealevel</span><span class="o">$</span><span class="n">date</span> <span class="o">=</span> <span class="nf">as.POSIXct</span><span class="p">(</span><span class="n">sealevel</span><span class="o">$</span><span class="n">date</span><span class="p">)</span>
<span class="n">sealevel</span><span class="o">$</span><span class="n">date</span> <span class="o">=</span> <span class="n">sealevel</span><span class="o">$</span><span class="n">date</span> <span class="o">+</span> <span class="n">sealevel</span><span class="o">$</span><span class="n">day_of_year</span> <span class="o">*</span> <span class="m">24</span> <span class="o">*</span> <span class="m">3600</span>
<span class="nf">head</span><span class="p">(</span><span class="n">sealevel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s do a plot using “date” as axis rather than decimalyear.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;ggplot2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sealevel</span><span class="p">)</span> <span class="o">+</span> 
  <span class="nf">geom_path</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sealevel</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>This looks quite similar until we zoom in. Maybe we are interested in two years only.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">as.POSIXct</span><span class="p">(</span><span class="s">&quot;2001-01-01&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">c</span><span class="p">(</span><span class="nf">as.POSIXct</span><span class="p">(</span><span class="s">&quot;1995-01-01&quot;</span><span class="p">),</span><span class="nf">as.POSIXct</span><span class="p">(</span><span class="s">&quot;1997-01-01&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="nf">as.POSIXct</span><span class="p">(</span><span class="s">&quot;1995-01-01&quot;</span><span class="p">)</span>
<span class="n">end</span>   <span class="o">=</span> <span class="nf">as.POSIXct</span><span class="p">(</span><span class="s">&quot;1997-01-01&quot;</span><span class="p">)</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sealevel</span><span class="p">)</span> <span class="o">+</span> 
  <span class="nf">geom_path</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sealevel</span><span class="p">))</span> <span class="o">+</span> 
  <span class="nf">scale_x_datetime</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Another advantage of <code class="docutils literal notranslate"><span class="pre">POSIXct</span></code> is that you can format it in any way you like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">format</span><span class="p">(</span><span class="n">sealevel</span><span class="o">$</span><span class="n">date</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="s">&quot;%d.%m.%Y&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">format()</span></code> function to get output in the following formats:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Apr</span> <span class="pre">04,</span> <span class="pre">1855</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4.</span> <span class="pre">April</span> <span class="pre">1855</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">17/04/1855</span> <span class="pre">11:17</span> <span class="pre">AM</span></code></p></li>
</ul>
<p>Hint: Getting help by typing <code class="docutils literal notranslate"><span class="pre">?format</span></code> will not tell you too much. But in the section “Details”, it will tell you which specific <code class="docutils literal notranslate"><span class="pre">format</span></code> function exists for your data type. So you need to check out the help for that function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#?format.POSIXct</span>
<span class="nf">format</span><span class="p">(</span><span class="n">sealevel</span><span class="o">$</span><span class="n">date</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="s">&quot;%b %m, %Y&quot;</span><span class="p">)</span>
<span class="nf">format</span><span class="p">(</span><span class="n">sealevel</span><span class="o">$</span><span class="n">date</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="s">&quot;%d. %B %Y&quot;</span><span class="p">)</span>
<span class="nf">format</span><span class="p">(</span><span class="n">sealevel</span><span class="o">$</span><span class="n">date</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="s">&quot;%d/%m/%Y %I:%M %p&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><span style="color: red;">Task: </span> Use the <code class="docutils literal notranslate"><span class="pre">format()</span></code> function to add a “month” column to our data.frame. Make sure it is numeric.</p>
<p><span style="color: red;">Task: </span> Plot the sea level data over a monthly time axis of 1 year length.</p>
<p>Hint: You can use the following command to get the x axis nice:</p>
<p><code class="docutils literal notranslate"><span class="pre">scale_x_continuous(name</span> <span class="pre">=</span> <span class="pre">&quot;month&quot;,</span> <span class="pre">limits=c(1,12),</span> <span class="pre">breaks=1:12)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="simple-linear-models">
<h2>2. Simple linear models<a class="headerlink" href="#simple-linear-models" title="Permalink to this headline">¶</a></h2>
<p>We skip this topic because we will have it in the time series analysis lecture.</p>
</div>
<div class="section" id="lists-vs-vectors">
<h2>3. Lists vs Vectors<a class="headerlink" href="#lists-vs-vectors" title="Permalink to this headline">¶</a></h2>
<p>You can have lists and vectors in R. They are different:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>Vectors</strong></p></th>
<th class="head"><p><strong>Lists</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>elements have</p></td>
<td><p>same type</p></td>
<td><p>possibly different type</p></td>
</tr>
<tr class="row-odd"><td><p>generating</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">=</span> <span class="pre">c(1,2,3)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">=</span> <span class="pre">list(1,&quot;abc&quot;,TRUE)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>accessing element <code class="docutils literal notranslate"><span class="pre">i</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">v[i]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">l[[i]]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>apply operations or functions</p></td>
<td><p>yes, directly</p></td>
<td><p>no, only using <code class="docutils literal notranslate"><span class="pre">lapply()</span></code></p></td>
</tr>
</tbody>
</table>
<p>When you call some functions, they often return a list, so you should know how to work with them. Let’s make an example. We create a histogram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="nf">hist</span><span class="p">(</span><span class="n">sealevel</span><span class="o">$</span><span class="n">sealevel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If we look at the Variable Inspector, it states that <code class="docutils literal notranslate"><span class="pre">a</span></code> is of type <code class="docutils literal notranslate"><span class="pre">histogram</span></code>. But actually, it’s just a list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">is.list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>So, we can access its elements.</p>
<p><span style="color: red;">Task: </span> Type <code class="docutils literal notranslate"><span class="pre">a$</span></code> and press the TAB key. You can see that you can access its elements by their name.</p>
<p>We can also access them by their index in the list using double square brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[[</span><span class="m">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>You can create your own lists like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;My list&quot;</span><span class="p">,</span> <span class="n">vector</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="n">mylist</span>
</pre></div>
</div>
</div>
</div>
<p>And we can easily add elements, by their name or index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span><span class="o">$</span><span class="n">histogram</span> <span class="o">=</span> <span class="n">a</span>
<span class="n">mylist</span><span class="p">[[</span><span class="m">4</span><span class="p">]]</span><span class="o">=</span><span class="s">&quot;Element 4&quot;</span>
<span class="n">mylist</span>
</pre></div>
</div>
</div>
</div>
<p>Note that the third element, <code class="docutils literal notranslate"><span class="pre">$histogram</span></code>, is also a list. So you can access its values by</p>
<p><code class="docutils literal notranslate"><span class="pre">mylist$histogram$counts</span></code></p>
<p>or by</p>
<p><code class="docutils literal notranslate"><span class="pre">mylist[[3]][[2]]</span></code></p>
<p><span style="color: red;">Bonus Task: </span> In part 1 of this introduction, we defined a function <code class="docutils literal notranslate"><span class="pre">largest_rises()</span></code>. Based on that, write a function <code class="docutils literal notranslate"><span class="pre">largest_rises_and_falls()</span></code> which will calculate both and then return a list with two elements: <code class="docutils literal notranslate"><span class="pre">rises</span></code> and <code class="docutils literal notranslate"><span class="pre">falls</span></code>.</p>
</div>
<div class="section" id="working-with-netcdf-data-plotting-a-simple-map">
<h2>4. Working with NetCDF data (plotting a simple map)<a class="headerlink" href="#working-with-netcdf-data-plotting-a-simple-map" title="Permalink to this headline">¶</a></h2>
<p>NetCDF is a very common file format that allows to store geospatial data.</p>
<p>Advantages:</p>
<ul class="simple">
<li><p>Commonly used</p></li>
<li><p>Self-describing (contains axes, units, …)</p></li>
<li><p>Searchable (possible to load parts of the file)</p></li>
<li><p>Binary file, compression possible (small file size)</p></li>
<li><p>…</p></li>
</ul>
<p>Disadvantages:</p>
<ul class="simple">
<li><p>can only be read/written with the NetCDF library (included in a variety of software).</p></li>
</ul>
<p>In R, there are several packages that allow working with NetCDF data. We will use the RNetCDF package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;RNetCDF&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>NetCDF files are not “loaded” like normal ascii files. Instead we</p>
<ul class="simple">
<li><p>“open” the file</p></li>
<li><p>“inquire” what is inside the file and</p></li>
<li><p>load what we need.</p></li>
</ul>
<p>We choose a file from the German Maritime and Hydrographic Agency (BSH) that contains SST for March of this year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nc</span> <span class="o">=</span> <span class="nf">open.nc</span><span class="p">(</span><span class="s">&quot;/students_files/data/bsh_sst.nc&quot;</span><span class="p">)</span>
<span class="n">fileinfo</span> <span class="o">=</span> <span class="nf">file.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span>
<span class="n">fileinfo</span>
</pre></div>
</div>
</div>
</div>
<p>You see we have 3 dimensions and 4 variables. We can again “inquire” what these dimensions and variables are. But they start with 0, not with 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;inquiring dimension 0&quot;</span><span class="p">)</span>
<span class="nf">dim.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;inquiring dimension 1&quot;</span><span class="p">)</span>
<span class="nf">dim.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;inquiring dimension 2&quot;</span><span class="p">)</span>
<span class="nf">dim.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="s">&quot;inquiring variable 0&quot;</span><span class="p">)</span>
<span class="nf">var.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;inquiring variable 1&quot;</span><span class="p">)</span>
<span class="nf">var.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;inquiring variable 2&quot;</span><span class="p">)</span>
<span class="nf">var.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="m">2</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="s">&quot;inquiring variable 3&quot;</span><span class="p">)</span>
<span class="nf">var.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let us write a function that makes it easier to check the variables in the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">list_variables</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fileinfo</span> <span class="o">=</span> <span class="nf">file.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">0</span><span class="o">:</span><span class="p">(</span><span class="n">fileinfo</span><span class="o">$</span><span class="n">nvars</span> <span class="o">-</span> <span class="m">1</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">varinfo</span> <span class="o">=</span> <span class="nf">var.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="n">varinfo</span><span class="o">$</span><span class="n">ndims</span><span class="p">,</span><span class="s">&quot; dim variable:    &quot;</span><span class="p">,</span><span class="n">varinfo</span><span class="o">$</span><span class="n">name</span><span class="p">))</span>
        <span class="nf">for </span><span class="p">(</span><span class="n">j</span> <span class="n">in</span> <span class="n">varinfo</span><span class="o">$</span><span class="n">dimids</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">diminfo</span> <span class="o">=</span> <span class="nf">dim.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;   &quot;</span><span class="p">,</span><span class="n">diminfo</span><span class="o">$</span><span class="n">name</span><span class="p">))</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">list_variables</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can then see which variable we may want to use. In our case it is mcsst that we want to plot, which depends on longitude, latitude and time. We can load the variable like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mcsst</span> <span class="o">=</span> <span class="nf">var.get.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="s">&quot;mcsst&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">mcsst</span></code> is an array. An array is something like a multidimensional matrix. Let us check its dimensions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">dim</span><span class="p">(</span><span class="n">mcsst</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>It has three dimensions. The last one is the time dimension. Let us plot the first time step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">image</span><span class="p">(</span><span class="n">mcsst</span><span class="p">[,,</span><span class="m">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>This looks a bit weird, doesn’t it?</p>
<p><span style="color: red;">Task: </span> Where can you find Denmark?</p>
<p>Maybe it makes sense to load the longitide and latitude values as well.</p>
<p><span style="color: red;">Task: </span> Load the longitude and latidude values and save them as <code class="docutils literal notranslate"><span class="pre">lon</span></code> and <code class="docutils literal notranslate"><span class="pre">lat</span></code>.</p>
<p>Now we can try to do a better <code class="docutils literal notranslate"><span class="pre">image</span></code> plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">image</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">mcsst</span><span class="p">[,,</span><span class="m">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Okay that didn’t work out but we got a nice error message.</p>
<p><span style="color: red;">Task: </span> Use the simple <code class="docutils literal notranslate"><span class="pre">plot()</span></code> function to check which of the axes <code class="docutils literal notranslate"><span class="pre">lat</span></code> or <code class="docutils literal notranslate"><span class="pre">lon</span></code> is not increasingly ordered.</p>
<p>Obviously we have to revert the lat axis. We can use the <code class="docutils literal notranslate"><span class="pre">rev()</span></code> function to reverse a vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lat</span> <span class="o">=</span> <span class="nf">rev</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>But then we also have to reverse the second dimension of the array. We can do it using the <code class="docutils literal notranslate"><span class="pre">apply()</span></code> function. The trick is, always give those indexes that you would <strong>not</strong> want to apply the function to (the axes that you would like to keep).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mcsst</span> <span class="o">=</span> <span class="nf">apply</span><span class="p">(</span><span class="n">mcsst</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">),</span> <span class="n">rev</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can try again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">image</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">mcsst</span><span class="p">[,,</span><span class="m">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Again a nice error message. It tells us we have to flip the dimensions (transpose a matrix). This can be done with the <code class="docutils literal notranslate"><span class="pre">t()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">image</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="nf">t</span><span class="p">(</span><span class="n">mcsst</span><span class="p">[,,</span><span class="m">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p>Wow, our first map! But, as always, we can draw much nicer ones using the <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> package. But to do so, we first have to create a data.frame like this:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>lon</p></th>
<th class="head"><p>lat</p></th>
<th class="head"><p>sst</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>-4</p></td>
<td><p>49</p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-odd"><td><p>-3</p></td>
<td><p>49</p></td>
<td><p>0.2</p></td>
</tr>
<tr class="row-even"><td><p>-2</p></td>
<td><p>49</p></td>
<td><p>NA</p></td>
</tr>
<tr class="row-odd"><td><p>…</p></td>
<td><p>…</p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
<p>It is easy to start with the <code class="docutils literal notranslate"><span class="pre">sst</span></code> column. We only have to use the <code class="docutils literal notranslate"><span class="pre">as.vector</span></code> function to convert the matrix to a vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sst_df</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">sst</span><span class="o">=</span><span class="nf">as.vector</span><span class="p">(</span><span class="n">mcsst</span><span class="p">[,,</span><span class="m">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p>For the longitude and latitude, we have to check which of them changes fastest. I always do that by try and error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sst_df</span><span class="o">$</span><span class="n">lon</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span>
<span class="n">sst_df</span><span class="o">$</span><span class="n">lat</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">each</span><span class="o">=</span><span class="nf">length</span><span class="p">(</span><span class="n">lon</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;ggplot2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sst_df</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_raster</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">sst</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>That looks ugly so we have to do it the other way around.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sst_df</span><span class="o">$</span><span class="n">lon</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">each</span><span class="o">=</span><span class="nf">length</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span>
<span class="n">sst_df</span><span class="o">$</span><span class="n">lat</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">lon</span><span class="p">))</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sst_df</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_raster</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">sst</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>But having a coastline would also be nice. Let us load one from a text file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">coastline</span> <span class="o">=</span> <span class="nf">read.csv2</span><span class="p">(</span><span class="s">&quot;/students_files/data/coastline_baltic.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">coastline</span><span class="p">)</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;lon&quot;</span><span class="p">,</span> <span class="s">&quot;lat&quot;</span><span class="p">)</span>
<span class="n">coastline</span><span class="o">$</span><span class="n">lon</span><span class="o">=</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">coastline</span><span class="o">$</span><span class="n">lon</span><span class="p">)</span>
<span class="n">coastline</span><span class="o">$</span><span class="n">lat</span><span class="o">=</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">coastline</span><span class="o">$</span><span class="n">lat</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">coastline</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s put it into the map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sst_df</span><span class="o">$</span><span class="n">lon</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">each</span><span class="o">=</span><span class="nf">length</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span>
<span class="n">sst_df</span><span class="o">$</span><span class="n">lat</span> <span class="o">=</span> <span class="nf">rep</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">lon</span><span class="p">))</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sst_df</span><span class="p">)</span> <span class="o">+</span> 
  <span class="nf">geom_raster</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">sst</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_path</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">lat</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">coastline</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">31</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">66</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">scale_fill_gradientn</span><span class="p">(</span><span class="n">colours</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;darkblue&quot;</span><span class="p">,</span><span class="s">&quot;green&quot;</span><span class="p">,</span><span class="s">&quot;yellow&quot;</span><span class="p">,</span><span class="s">&quot;red&quot;</span><span class="p">),</span> <span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.3</span><span class="p">,</span><span class="m">0.7</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> <span class="n">na.value</span> <span class="o">=</span> <span class="s">&quot;white&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><span style="color: red;">Bonus Task: </span> Create a temporal mean over the 13 days using the <code class="docutils literal notranslate"><span class="pre">apply()</span></code> function (using <code class="docutils literal notranslate"><span class="pre">mean</span></code> with <code class="docutils literal notranslate"><span class="pre">na.rm=TRUE</span></code>) and do a plot of this mean temperature from March 1st to 13th.</p>
<p>We have not yet made use of the <strong>attributes</strong> of the variables in the NetCDF file. They are important because they may contain the unit or a description of what the variable actually is.</p>
<p>Let us look at the result of <code class="docutils literal notranslate"><span class="pre">var.inq.nc()</span></code> for the <code class="docutils literal notranslate"><span class="pre">time</span></code> variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">var.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="s">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>There are 4 attributes for this variable. Let’s look at the first one:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">att.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
<span class="nf">att.get.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Again it may make sense to write a small function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">list_attributes</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span> <span class="n">varname</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">varinfo</span> <span class="o">=</span> <span class="nf">var.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span> <span class="n">varname</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="n">varinfo</span><span class="o">$</span><span class="n">natts</span><span class="p">,</span><span class="s">&quot; attributes for variable &quot;</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="s">&quot;:&quot;</span><span class="p">))</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">0</span><span class="o">:</span><span class="p">(</span><span class="n">varinfo</span><span class="o">$</span><span class="n">natts</span> <span class="o">-</span> <span class="m">1</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">attinfo</span> <span class="o">=</span> <span class="nf">att.inq.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
        <span class="n">attvalue</span> <span class="o">=</span> <span class="nf">att.get.nc</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;   &quot;</span><span class="p">,</span><span class="n">attinfo</span><span class="o">$</span><span class="n">name</span><span class="p">,</span><span class="s">&quot; = &quot;</span><span class="p">,</span><span class="n">attvalue</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">list_attributes</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span> <span class="s">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><span style="color: red;">Bonus Task: </span> Read the <code class="docutils literal notranslate"><span class="pre">time</span></code> variable. Use the information you see in the <code class="docutils literal notranslate"><span class="pre">units</span></code> attribute to create a time axis in the <code class="docutils literal notranslate"><span class="pre">POSIXct</span></code> format. Then, create a time series plot for <code class="docutils literal notranslate"><span class="pre">mcsst[185,144,]</span></code></p>
</div>
<div class="section" id="basic-statistical-tests">
<h2>5. Basic statistical tests<a class="headerlink" href="#basic-statistical-tests" title="Permalink to this headline">¶</a></h2>
<p>If you want to do statistical tests, most of them are already implemented in R. The trick is to find out which of your tests is appropriate for your research question.</p>
<p>Some commonly used tests are explained here:</p>
<p>[ <a class="reference external" href="http://r-statistics.co/Statistical-Tests-in-R.html">http://r-statistics.co/Statistical-Tests-in-R.html</a> ]</p>
<p>A large overview on statistical tests can be found here:</p>
<p>[ <a class="reference external" href="http://www.biostathandbook.com/testchoice.html">http://www.biostathandbook.com/testchoice.html</a> ]</p>
<p>Let’s just create two random time series and do a few statistical tests on them to see how it works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">series1</span> <span class="o">=</span> <span class="nf">runif</span><span class="p">(</span><span class="m">100</span><span class="p">)</span>
<span class="n">series2</span> <span class="o">=</span> <span class="nf">runif</span><span class="p">(</span><span class="m">100</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">series1</span><span class="p">)</span>
<span class="nf">points</span><span class="p">(</span><span class="n">series2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">t.test</span><span class="p">(</span><span class="n">series1</span><span class="p">,</span> <span class="n">series2</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s">&quot;greater&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><span style="color: red;">Task: </span> Try to extract the p-value and save it in a variable <code class="docutils literal notranslate"><span class="pre">p</span></code>. Hint: use the <code class="docutils literal notranslate"><span class="pre">is.list()</span></code> function to check if the result of <code class="docutils literal notranslate"><span class="pre">t.test()</span></code> is a list.</p>
<p><span style="color: red;">Task: </span> Go to the following webpage</p>
<p>[ <a class="reference external" href="http://www.biostathandbook.com/testchoice.html">http://www.biostathandbook.com/testchoice.html</a> ]</p>
<p>and find a test to check whether the variance differs between the two vectors. Do this test in R.</p>
<p>Hint: The functions are typically named like the tests. Type the first letters of the test name and then push the tab key (autocomplete) to see whuch functions are available.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="intro_r_1.html" title="previous page">Introduction into R - Part 1</a>
    <a class='right-next' id="next-link" href="statistical_tests.html" title="next page">Statistical tests in R</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Florian Börgel<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>